/**
 * Sanitizes incoming request payload
 */

function sanitizeObject(obj) {
    const sanitized = {};
    for (const key in obj) {
        if (typeof obj[key] === "string") {
            sanitized[key] = obj[key].trim();
        } else {
            sanitized[key] = obj[key];
        }
    }
    return sanitized;
}

function sanitizeRequest(req, res, next) {
    if (req.body) {
        req.body = sanitizeObject(req.body);
    }
    if (req.query) {
        req.query = sanitizeObject(req.query);
    }
    next();
}

module.exports = sanitizeRequest;
